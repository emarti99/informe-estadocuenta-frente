<!-- Tabla principal -->

<p-table *ngIf="prestamos" [value]="prestamos" dataKey="prestamos_socio_nro_pmo"
  styleClass="p-datatable-sm p-datatable-responsive-demo">
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 3rem"></th>
      <th pSortableColumn="prestamos_socio_aprobado_fecha">Fecha apro. <p-sortIcon
          field="prestamos_socio_aprobado_fecha">
        </p-sortIcon>
      </th>
      <th pSortableColumn="prestamos_socio_monto">Monto <p-sortIcon field="prestamos_socio_monto">
        </p-sortIcon>
      </th>
      <th pSortableColumn="prestamos_socio_sistema">Sistema <p-sortIcon field="prestamos_socio_sistema">
        </p-sortIcon>
      </th>
      <th pSortableColumn="prestamos_socio_cuotas">Cuotas 
      </th>
      <th pSortableColumn="prestamos_socio_tipo_pmo">Tipo 
      </th>
      <th pSortableColumn="prestamos_socio_calificacion">Calificación <p-sortIcon
          field="prestamos_socio_calificacion">
        </p-sortIcon>
      </th>
      <th pSortableColumn="prestamos_socio_atrasos">Atrasos <p-sortIcon field="prestamos_socio_atrasos">
        </p-sortIcon>
      </th>
      <th pSortableColumn="prestamos_socio_fecha_vencimiento">Vencimiento <p-sortIcon
          field="prestamos_socio_fecha_vencimiento">
        </p-sortIcon>
      </th>
      <th pSortableColumn="prestamos_socio_estado_pmo">Estado <p-sortIcon field="prestamos_socio_estado_pmo">
        </p-sortIcon>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-campo let-expanded="expanded">
    <tr class="resalta-filas"
      [class]="campo.prestamos_socio_estado_pmo == 'Cobro normal' && campo.prestamos_socio_aprobado_fecha != null ? 'verde' : campo.prestamos_socio_estado_pmo ==
      'Juicio/Cob' ? 'rojo' :  campo.prestamos_socio_estado_pmo == 'Solicitud' ? 'amarillo' : '' ">
      <td>
        <button type="button" pButton pRipple [pRowToggler]="campo"
          class="p-button-text p-button-rounded p-button-plain"
          [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Fecha aprobación</span>{{campo.prestamos_socio_aprobado_fecha | formatoFecha}}
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Monto</span>
        {{campo.prestamos_socio_monto | currency:'PYG':'symbol-narrow':'1.0':'py'}}
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Sistema</span>
        {{campo.prestamos_socio_sistema}}
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Cuotas</span>
        {{campo.prestamos_socio_cuotas}}
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Tipo</span>
        {{campo.prestamos_socio_tipo_pmo | titlecase}}
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Calificación</span>
        {{campo.prestamos_socio_calificacion}}
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Atrasos</span>
        {{campo.prestamos_socio_atrasos}}
      </td>
      <td [pRowToggler]="campo">
        <span class="p-column-title">Vencimiento</span>
        {{campo.prestamos_socio_fecha_vencimiento | formatoFecha}}
      </td>
      <td>
        <span class="p-column-title">Estado</span>
        {{campo.prestamos_socio_estado_pmo | titlecase}}
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="rowexpansion" let-campo>
    <tr class="contenedor-desplegable">
      <td colspan="10">
        <div class="p-p-0">

          <!-- Tabla secundaria ( desplegable ) -->

          <p-table [value]="prestamos" dataKey="prestamos_socio_saldo_restante"
            styleClass="p-datatable-sm desplegable p-datatable-responsive-demo">
            <ng-template pTemplate="header">
    <tr>
      <th>Saldo restante </th>
      <th>Tasa de interés </th>
      <th>Situación </th>
      <th>Cuotas adelantadas </th>
      <th>Cuotas en fecha </th>
      <th>Max días de atraso </th>
      <th>Tipo de Garantía </th>
      <th>Socio garante </th>
      <th>Observación </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowIndex="rowIndex">
    <tr *ngIf="rowIndex == 0">
      <td>
        <span class="p-column-title">Saldo restante</span>
        {{campo.prestamos_socio_saldo_restante | currency:'PYG':'symbol-narrow':'1.0':'py'}}
      </td>
      <td>
        <span class="p-column-title">Tasa de interés</span>
        {{campo.prestamos_socio_tasa_interes}}
      </td>
      <td>
        <span class="p-column-title">Situación</span>
        {{campo.prestamos_socio_situacion | titlecase}}
      </td>
      <td>
        <span class="p-column-title">Cuotas adelantadas</span>
        {{campo.prestamos_socio_adelantado}}
      </td>
      <td>
        <span class="p-column-title">Cuotas en fecha</span>
        {{campo.prestamos_socio_en_fecha}}
      </td>
      <td>
        <span class="p-column-title">Max días de atraso</span>
        {{campo.prestamos_socio_max_dias_atraso}}
      </td>
      <td>
        <span class="p-column-title">Tipo de Garantía</span>
        {{campo.prestamos_socio_tipo_garantia | titlecase}}
      </td>
      <td>
        <span class="p-column-title">Socio garante</span>
        {{campo.prestamos_socio_socio_garante}}
      </td>
      <td>
        <span class="p-column-title">Observación</span>
        {{campo.prestamos_socio_observacion | titlecase}}
      </td>
    </tr>
  </ng-template>
</p-table>
</div>
</td>
</tr>
</ng-template>
<ng-template pTemplate="emptymessage">
  <tr>
    <td colspan="10" class="mensajeNoDatos">No hay prestamos</td>
  </tr>
</ng-template>
</p-table>
