<h2>Préstamos</h2>

<!-- Tabla principal -->

<p-table [value]="prestamos" dataKey="PRES_socio_nro_pmo" styleClass="p-datatable-sm">
  <ng-template pTemplate="header">
    <tr>
      <th style="width: 3rem"></th>
      <th pSortableColumn="PRES_socio_aprobado_fecha" style="width: 12rem">Fecha aprobación <p-sortIcon
          field="PRES_socio_aprobado_fecha">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_monto" style="width: 7rem">Monto <p-sortIcon field="PRES_socio_monto">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_sistema" style="width: 7rem">Sistema <p-sortIcon field="PRES_socio_sistema">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_cuotas" style="width: 7rem">Cuotas <p-sortIcon field="PRES_socio_cuotas">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_tipo_pmo" style="width: 8rem">Tipo <p-sortIcon field="PRES_socio_tipo_pmo">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_calificacion" style="width: 9rem">Calificación <p-sortIcon
          field="PRES_socio_calificacion">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_atrasos" style="width: 7rem">Atrasos <p-sortIcon field="PRES_socio_atrasos">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_fecha_vencimiento" style="width: 9rem">Vencimiento <p-sortIcon
          field="PRES_socio_fecha_vencimiento">
        </p-sortIcon>
      </th>
      <th pSortableColumn="PRES_socio_estado_pmo" style="width: 7rem">Estado <p-sortIcon field="PRES_socio_estado_pmo">
        </p-sortIcon>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-product let-expanded="expanded">
    <tr>
      <td>
        <button type="button" pButton pRipple [pRowToggler]="product"
          class="p-button-text p-button-rounded p-button-plain"
          [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
      </td>
      <td>{{product.PRES_socio_aprobado_fecha}}</td>
      <td>{{product.PRES_socio_monto | currency:'PYG':'symbol-narrow':'1.0':'py'}}</td>
      <td>{{product.PRES_socio_sistema}}</td>
      <td>{{product.PRES_socio_cuotas}}</td>
      <td>{{product.PRES_socio_tipo_pmo}}</td>
      <td>{{product.PRES_socio_calificacion}}</td>
      <td>{{product.PRES_socio_atrasos}}</td>
      <td>{{product.PRES_socio_fecha_vencimiento}}</td>
      <td><span
          [class]="'product-badge status-' + product.PRES_socio_estado_pmo.toLowerCase()">{{product.PRES_socio_estado_pmo}}</span>
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="rowexpansion" let-product>
    <tr>
      <td colspan="10">
        <div class="p-p-3">

          <!-- Tabla secundaria ( desplegable ) -->

          <p-table [value]="prestamos" dataKey="PRES_socio_mas_detalles.PRDE_socio_nro_pmo" styleClass="p-datatable-sm">
            <ng-template pTemplate="header">
    <tr>
      <th>Saldo restante </th>
      <th>Tasa de interes </th>
      <th>Situación </th>
      <th>Cuotas adelantadas </th>
      <th>Cuotas en fecha </th>
      <th>Max días de atraso </th>
      <th>Tipo de Garantía </th>
      <th>Socio garante </th>
      <th style="width: 10rem">Observación </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowIndex="rowIndex">
    <tr *ngIf="rowIndex == 1">
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_saldo_restante}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_tasa_interes}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_situacion}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_adelantado}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_en_fecha}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_max_dias_atraso}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_tipo_garantia}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_socio_garante}}</td>
      <td>{{product.PRES_socio_mas_detalles.PRDE_socio_observacion}}</td>
    </tr>
  </ng-template>
  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="6">No hay datos.</td>
    </tr>
  </ng-template>
</p-table>
</div>
</td>
</tr>
</ng-template>
</p-table>
